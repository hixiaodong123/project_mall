<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.cskaoyan.mall.mapper.StatisticMapper">

    <select id="selectUserStatData" resultType="map">
        select substring(add_time,1,10) as `day` , count(id) as users
        from cskaoyan_mall_user
        group by `day`
    </select>

    <select id="selectOrderStatData" resultType="map">
        select count(id) as orders , count(distinct user_id) as customers , substring(add_time,1,10) as day,
                sum(goods_price) as amount , (sum(goods_price) / count(user_id)) as pcr
        from cskaoyan_mall_order
        group by day
    </select>

    <select id="selectGoodsStatData" resultType="map">
        select count(id) as orders , sum(number) as products , (sum(number * price)) as amount ,
                substring(add_time,1,10) as day
        from  cskaoyan_mall_order_goods
        group by day
    </select>
</mapper>